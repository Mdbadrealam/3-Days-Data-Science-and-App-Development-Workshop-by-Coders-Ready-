# -*- coding: utf-8 -*-
"""workshop day 2

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1Ri0lpLkYtjB_9FpeNdwPxnOqVM1J1q6_

workshop day-2
"""

from google.colab import drive
drive.mount('/content/drive')

import pandas as pd
import plotly.express as pr
import plotly.graph_objects as go

df = pd.read_csv('/content/drive/MyDrive/project_dataset.csv.xls')

df

df.head(12)

df.shape

df.dtypes

df.info

df.describe()

df.duplicated()

df.isna()

df.isna()

df.isna().sum()/df.shape[0]

df.dropna(axis=1, inplace=True)

df

data = df.sample(n=500, random_state=42)

data

data.count()

fig = go.Figure(data = go.Scatter(x=df['Distance'],y = df['DepTimeBlk'],mode='markers', marker=dict(color='red')))
fig.update_layout(title = 'Scatter Plot for Distance vs Departure time', xaxis_title = 'Distance Time',yaxis_title ='Departure Time')
fig.show()

line_data = df.groupby('Month')['Diverted'].mean().reset_index()
line_data

fig = go.Figure(data = go.Scatter(x=line_data['Month'],y = line_data['Diverted'],mode='lines', marker=dict(color='green')))
fig.update_layout(title = 'Monthly average diverted plot for an year', xaxis_title = 'Months',yaxis_title ='Diverted of flights (in minutes)')
fig.show()

fig = go.Figure(data = go.Scatter(x=line_data['Month'],y = line_data['Diverted'],mode='lines', marker=dict(color='Blue')))
fig.update_layout(title = 'Monthly average diverted plot for an year', xaxis_title = 'Months',yaxis_title ='Diverted of flights (in minutes)')
fig.show()

bar_data = df.groupby('DestCityName')['Flights'].sum().reset_index()
bar_data

fig = pr.bar(bar_data,x='DestCityName',y='Flights', title = 'Total number of flights from each destination city')
fig.show()

bub_data = df.groupby('Reporting_Airline')['Flights'].sum().reset_index()
bub_data

fig = pr.scatter(bub_data,x='Reporting_Airline',y='Flights', title = 'Total number of flights per reporting airlines',size = 'Flights',hover_name='Reporting_Airline',size_max=60)
fig.show()

